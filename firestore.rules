
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Règle pour la collection "clients"
    match /clients/{userId} {
      // Un utilisateur authentifié peut lire son propre document client.
      // La variable `request.auth.uid` contient l'UID de l'utilisateur qui fait la demande.
      // On vérifie qu'elle correspond à l'ID du document (`userId`).
      allow read: if request.auth != null && request.auth.uid == userId;

      // Seul un utilisateur authentifié (que nous considérons comme un admin dans notre logique d'app)
      // peut créer, mettre à jour ou supprimer des documents clients.
      // Note : Pour une sécurité renforcée en production, il faudrait une gestion
      // des rôles (par exemple, un champ "isAdmin" sur le document utilisateur).
      allow create, update, delete: if request.auth != null; 
      
      // La liste complète des clients ne peut être lue que par un utilisateur authentifié (admin).
      allow list: if request.auth != null;
    }
  }
}
